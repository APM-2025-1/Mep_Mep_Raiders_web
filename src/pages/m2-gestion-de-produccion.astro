---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import PricingCmp from '../components/Pricing.astro';
import Newsletter from '../components/Newsletter.astro';
import Footer from '../components/Footer.astro';
import HeroSection from '../components/HeroSection.astro';
---

<Layout title="Mep Mep Raiders - Módulo 2: Gestión de Producción" description="Explora el análisis de una planta mediante software de simulación, integrando fallas de equipos, disponibilidad, calidad, tiempos de set-up y producción, balance de líneas, gestión de colas y cálculo del OEE. Aprende sobre estrategias de pre-automatización y la integración con sistemas MES.">
  <Header />
  <main>
    <HeroSection 
      title="Módulo 2: Gestión de Producción" 
      highlightText="Módulo 2:"
      description="Este módulo aborda el análisis de una planta mediante software de simulación, integrando aspectos clave como fallas de equipos, disponibilidad, calidad, tiempos de set-up y producción, balance de líneas, gestión de colas y cálculo del OEE. Se consideran además estrategias de pre-automatización, con el uso de diagramas VSM antes y después de aplicar mejoras. Finalmente, se propone una metodología para integrar los datos generados en planta con un sistema MES (Manufacturing Execution System)"
    />

    <!-- VSM Viejito -->
    <section class="section relative z-10 overflow-hidden py-12 md:py-16">
      <div class="container-custom">

        <div class="text-center max-w-3xl mx-auto mb-8 md:mb-16 px-4">
          <span class="inline-block px-4 py-1 rounded-full bg-primary-100 dark:bg-primary-900 text-primary-600 dark:text-primary-300 font-medium text-sm mb-4">
            Pre-automatización
          </span>
          <h2 class="text-2xl md:text-3xl mb-4 md:mb-6 text-gray-900 dark:text-white">Diagrama VSM</h2>
          <p class="text-gray-600 dark:text-gray-300">
            Analisis de producción en la pre-automatización.
          </p>
        </div>
        
        <div class="relative mx-auto max-w-full h-[520px] overflow-hidden bg-white rounded-lg" id="zoomWrapper1">

          <img src="https://imgur.com/d7R0lIO.png"
              id="zoomImage1"
              class="absolute top-0 left-0 transition-transform ease-out duration-100 origin-top-left"
          />

          <!-- Controles -->
          <div class="absolute bottom-4 right-4 z-10 grid grid-cols-3 grid-rows-3 gap-2 bg-primary-500 dark:bg-primary-900 p-2 rounded-lg shadow-md">
            <div></div>
            <button id="moveUp1" class="w-10 h-10 bg-accent-400 text-primary-600 hover:bg-accent-500 dark:bg-accent-600 text-primary-800 rounded hover:bg-accent-700">↑</button>
            <div></div>

            <button id="moveLeft1" class="w-10 h-10 bg-accent-400 text-primary-600 hover:bg-accent-500 dark:bg-accent-600 text-primary-800 rounded hover:bg-accent-700">←</button>
            <button id="centerBtn1" class="w-10 h-10 bg-info-200 text-primary-600 rounded hover:bg-info-400 dark:bg-info-400 text-primary-800 rounded hover:bg-info-600">⟳</button>
            <button id="moveRight1" class="w-10 h-10 bg-accent-400 text-primary-600 hover:bg-accent-500 dark:bg-accent-600 text-primary-800 rounded hover:bg-accent-700">→</button>

            <button id="zoomOut1" class="w-10 h-10 bg-info-200 text-primary-600 rounded hover:bg-info-400 dark:bg-info-400 text-primary-800 rounded hover:bg-info-600">−</button>
            <button id="moveDown1" class="w-10 h-10 bg-accent-400 text-primary-600 hover:bg-accent-500 dark:bg-accent-600 text-primary-800 rounded hover:bg-accent-700">↓</button>
            <button id="zoomIn1" class="w-10 h-10 bg-info-200 text-primary-600 rounded hover:bg-info-400 dark:bg-info-400 text-primary-800 rounded hover:bg-info-600">+</button>
          </div>
        </div>
      </div>
    </section>

    <!-- VSM Nuevo -->
    <section class="section bg-gray-50 dark:bg-gray-800/50 relative overflow-hidden py-12 md:py-16">
      <div class="container-custom">

        <div class="text-center max-w-3xl mx-auto mb-8 md:mb-16 px-4">
          <span class="inline-block px-4 py-1 rounded-full bg-primary-100 dark:bg-primary-900 text-primary-600 dark:text-primary-300 font-medium text-sm mb-4">
            Post-automatización
          </span>
          <h2 class="text-2xl md:text-3xl mb-4 md:mb-6 text-gray-900 dark:text-white">Diagrama VSM</h2>
          <p class="text-gray-600 dark:text-gray-300">
            Analisis de producción en la post-automatización.
          </p>
        </div>

        <div class="relative mx-auto max-w-full h-[800px] overflow-hidden bg-white rounded-lg" id="zoomWrapper2">

          <img src="https://i.imgur.com/r3Lzkl6.png"
              id="zoomImage2"
              class="absolute top-0 left-0 transition-transform ease-out duration-100 origin-top-left"
          />

          <!-- Controles -->
          <div class="absolute bottom-4 right-4 z-10 grid grid-cols-3 grid-rows-3 gap-2 bg-primary-500 dark:bg-primary-900 p-2 rounded-lg shadow-md">
            <div></div>
            <button id="moveUp2" class="w-10 h-10 bg-accent-400 text-primary-600 hover:bg-accent-500 dark:bg-accent-600 text-primary-800 rounded hover:bg-accent-700">↑</button>
            <div></div>

            <button id="moveLeft2" class="w-10 h-10 bg-accent-400 text-primary-600 hover:bg-accent-500 dark:bg-accent-600 text-primary-800 rounded hover:bg-accent-700">←</button>
            <button id="centerBtn2" class="w-10 h-10 bg-info-200 text-primary-600 rounded hover:bg-info-400 dark:bg-info-400 text-primary-800 rounded hover:bg-info-600">⟳</button>
            <button id="moveRight2" class="w-10 h-10 bg-accent-400 text-primary-600 hover:bg-accent-500 dark:bg-accent-600 text-primary-800 rounded hover:bg-accent-700">→</button>

            <button id="zoomOut2" class="w-10 h-10 bg-info-200 text-primary-600 rounded hover:bg-info-400 dark:bg-info-400 text-primary-800 rounded hover:bg-info-600">−</button>
            <button id="moveDown2" class="w-10 h-10 bg-accent-400 text-primary-600 hover:bg-accent-500 dark:bg-accent-600 text-primary-800 rounded hover:bg-accent-700">↓</button>
            <button id="zoomIn2" class="w-10 h-10 bg-info-200 text-primary-600 rounded hover:bg-info-400 dark:bg-info-400 text-primary-800 rounded hover:bg-info-600">+</button>
          </div>
        </div>
      </div>
    </section>

    <section class="section bg-linear-to-br from-primary-600 to-primary-800 dark:from-primary-800 dark:to-primary-900 text-white py-12 md:py-16">
      <div class="container-custom">
        <div class="text-center max-w-3xl mx-auto mb-2 md:mb-16 px-4">
          <span class="inline-block px-4 py-1 rounded-full bg-primary-100 dark:bg-primary-900 text-primary-600 dark:text-primary-300 font-medium text-sm mb-4">
            Módulo 2
          </span>
          <h2 class="text-2xl md:text-3xl mb-4 md:mb-2 text-gray-900 dark:text-white">Links</h2>
          <p class="text-gray-600 dark:text-gray-300">
            Documentación y recursos del módulo.
          </p>
        </div>

        <div class="max-w-4xl mx-auto">
          <h2 class="text-2xl font-bold mb-4">Ver diagramas VSM</h2>
          <a 
            href="https://drive.google.com/drive/folders/1WGjEPawPsQ1XWnefKyT5CJ80m1k-SVqR?usp=drive_link"
            target="_blank"
            rel="noopener"
            class="inline-block bg-info-200 dark:bg-info-300 text-info-800 dark:text-info-900 px-6 py-3 rounded-lg shadow hover:bg-info-400 dark:hover:bg-info-600 transition">
            Abrir drive (Acceso con correo de dominio UNAL)
          </a>

          <h2 class="text-2xl font-bold mb-4 mt-4">Ver documentación</h2>
          <a 
            href="https://github.com/APM-2025-1/M2_Gestion_de_produccion"
            target="_blank"
            rel="noopener"
            class="inline-block bg-info-200 dark:bg-info-300 text-info-800 dark:text-info-900 px-6 py-3 rounded-lg shadow hover:bg-info-400 dark:hover:bg-info-600 transition">
            Documentación del módulo en github
          </a>
      </div>
    </section>

  </main>
  <Footer />
</Layout>

<script>
  function setupZoomSystem(wrapper, image, zoomInBtn, zoomOutBtn, centerBtn, moveUpBtn, moveDownBtn, moveLeftBtn, moveRightBtn) {
    let scale = 1;
    let translateX = 0;
    let translateY = 0;
    let naturalWidth = 0;
    let naturalHeight = 0;

    function updateTransform() {
      image.style.transform = `translate(${translateX}px, ${translateY}px) scale(${scale})`;
    }

    function centerImage() {
      const wrapperRect = wrapper.getBoundingClientRect();
      scale = 1;
      translateX = 0;
      translateY = 0;
      updateTransform();
    }

    image.addEventListener('load', () => {
      const wrapperRect = wrapper.getBoundingClientRect();
      naturalWidth = image.naturalWidth;
      naturalHeight = image.naturalHeight;

      const scaleFit = Math.min(wrapperRect.width / naturalWidth, wrapperRect.height / naturalHeight);
      scale = scaleFit;

      centerImage();
    });

    function zoom(factor) {
      const wrapperRect = wrapper.getBoundingClientRect();
      const centerX = wrapperRect.width / 2 - translateX;
      const centerY = wrapperRect.height / 2 - translateY;

      const newScale = Math.min(Math.max(0.2, scale * factor), 5);
      translateX -= centerX * (newScale - scale) / scale;
      translateY -= centerY * (newScale - scale) / scale;
      scale = newScale;
      updateTransform();
    }

    zoomInBtn.addEventListener('click', () => zoom(1.2));
    zoomOutBtn.addEventListener('click', () => zoom(1 / 1.2));
    centerBtn.addEventListener('click', () => centerImage());

    const moveStep = 40;
    moveUpBtn.addEventListener('click', () => { translateY += moveStep; updateTransform(); });
    moveDownBtn.addEventListener('click', () => { translateY -= moveStep; updateTransform(); });
    moveLeftBtn.addEventListener('click', () => { translateX += moveStep; updateTransform(); });
    moveRightBtn.addEventListener('click', () => { translateX -= moveStep; updateTransform(); });
  }

  // Inicializar sistema para el primer grupo
  setupZoomSystem(
    document.getElementById('zoomWrapper1'),
    document.getElementById('zoomImage1'),
    document.getElementById('zoomIn1'),
    document.getElementById('zoomOut1'),
    document.getElementById('centerBtn1'),
    document.getElementById('moveUp1'),
    document.getElementById('moveDown1'),
    document.getElementById('moveLeft1'),
    document.getElementById('moveRight1')
  );

  // Inicializar sistema para el segundo grupo
  setupZoomSystem(
    document.getElementById('zoomWrapper2'),
    document.getElementById('zoomImage2'),
    document.getElementById('zoomIn2'),
    document.getElementById('zoomOut2'),
    document.getElementById('centerBtn2'),
    document.getElementById('moveUp2'),
    document.getElementById('moveDown2'),
    document.getElementById('moveLeft2'),
    document.getElementById('moveRight2')
  );
</script>

